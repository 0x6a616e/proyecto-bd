<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/custom.css">
    <link rel="stylesheet" href="/static/css/custom.css.map">
    <title>Administración Citas Arte Dental</title>
</head>
<body >
    <header class="">
        <nav class="px-5 navbar navbar-expand-sm bg-white fixed-top">
            <div class="container-fluid">
                <!--LOGO-->
                <a class="navbar-brand" href='/'>
                    <img src="/static/images/arte dental logo.png">
                </a>
                <!--NAV TAB-->
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link text-morado" href="/admin_pacientes">
                            Pacientes
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-morado" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
                            Clínicas
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/admin_sucursales">Sucursales</a></li>
                            <li><a class="dropdown-item" href="/admin_dentistas">Dentistas</a></li>
                            <li><a class="dropdown-item" href="/admin_horarios">Horarios</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-morado" href="/admin_servmed">
                                Servicios y medicamentos
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-morado" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
                            Citas
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/admin_citas">Citas agendadas</a></li>
                            <li><a class="dropdown-item" href="/admin_notas">Notas</a></li>
                            <li><a class="dropdown-item" href="/admin_recetas">Recetas</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
        <hr class="" style="height:50px; border-width:0; color:gray; background-color:blue">
    </header>
    <hr class="" style="height:30px; opacity: 1; background-color: #6600A1">
    
    <main class="px-5">
        <h1 class="text-center">Administración</h1>
        <p>
            Bienvenide, administradore. Aquí puedes realizar, según las especificaciones
            de cada tabla, operaciones CRUD, lo cual conlleva crear, leer, actualizar y borrar
            datos, y lo mejor es que usarás una interfaz, ya que no eres ITC, figlio di Troia.
            Baci nel senza-angoli.
        </p>
        <!--TABS-->
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link text-morado active" data-bs-toggle="tab" href="#menu_citas">
                    Citas
                </a>
            </li>
        </ul>
        <div class="tab-content">
            <!--CONTENEDOR DE CRUD DE DENTISTAS-->
            <div id="menu_citas" class="container tab-pane active"><br>
                <h3>Citas</h3>
                <!--PILLS-->
                <ul class="nav nav-pills" role="tablist">
                    <li class="nav-item">
                        <button onclick="" class="nav-link active" id="btp1" data-bs-toggle="pill" href="#op1" 
                        type="button" role="pill" aria-controls="op1" aria-selected="true">
                        Borrar cita
                        </button>
                    </li>
                    <li class="nav-item">
                        <button onclick="" class="nav-link" id="btp2" data-bs-toggle="pill" href="#op2"
                        type="button" role="pill" aria-controls="op2" aria-selected="false">
                            Registrar sala de cita
                        </button>
                    </li>
                    <li class="nav-item">
                        <button onclick="" class="nav-link" id="btp3" data-bs-toggle="pill" href="#op3" 
                        type="button" role="pill" aria-controls="op3" aria-selected="false">
                            Mostrar citas
                        </button>
                    </li>
                </ul>
                <!--menu pills-->
                <div class="tab-content">
                    <div id="op1" class="container tab-pane active">
                        <form id="form-borrar-cita" action="/admin_borrar_cita" method="POST">
                            <div class="row pt-4">
                                <div class="col-sm-5">
                                    <label>ID Cita</label>
                                    <input name="cid-field" type="text" class="form-control" id="cid-field" required>
                                </div>
                            </div>
                            <div class="row pt-4">
                                <button class="btn btn-morado col-sm-3" type="submit">Borrar</button>
                            </div>
                        </form>
                    </div>
                    <div id="op2" class="container tab-pane fade">
                        <form id="form-nuevo" action="/admin_modificar_citas" method="POST">
                            <input type="hidden" name="tabla" value="citas">
                            <input type="hidden" name="id_nombre" value="cid">
                            <div class="row pt-4">
                                <div class="col">
                                    <label>ID Cita</label>
                                    <input name="id" type="text" class="form-control" id="id-field" placeholder="1111" required>
                                </div>
                                <div class="col">
                                    <label>Atributo a modificar</label>
                                    <select class="form-control" id="atributo-field" name="atributo" required>
                                        <option disabled selected>Selecciona un atributo</option>
                                        <option>numero_sala</option>
                                    </select>
                                </div>
                                <div class="col">
                                    <label>Valor nuevo</label>
                                    <input name="valor" type="text" class="form-control" id="valor-field" placeholder="valor" required>
                                </div>
                            </div>
                            <div class="row pt-4">
                                <button class="btn btn-morado col-sm-3" type="submit">Modificar</button>
                            </div>
                        </form>
                    </div>
                    <div id="op3" class="container tab-pane fade">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                        <th>ID</th>
                                        <th>ID Paciente</th>
                                        <th>ID Dentista</th>
                                        <th>ID Servicio</th>
                                        <th>Fecha</th>
                                        <th>Hora de inicio</th>
                                        <th>Número de sala</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for cita in citas %}
                                <tr>
                                <td>{{ cita[0] }}</td>
                                <td>{{ cita[1] }}</td>
                                <td>{{ cita[2] }}</td>
                                <td>{{ cita[3] }}</td>
                                <td>{{ cita[4] }}</td>
                                <td>{{ cita[5] }}</td>
                                <td>{{ cita[6] }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <hr class="" style="height:10px; opacity: 1; background-color: #6600A1">

    <script src="/static/node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/node_modules/jquery/dist/jquery.slim.js"></script>
    <script type="text/javascript">
        let tabActiva = 1;
        $("#btp1").addClass("text-white bg-morado");
        for (var i = 2; i < 4; i++) {
            $("#btp"+i).addClass("text-morado");
        }

        $("#btp1").on("click", function() {
            $("#btp"+tabActiva).removeClass("text-white bg-morado");
            $("#btp"+tabActiva).addClass("text-morado");
            tabActiva = 1;
            $("#btp"+tabActiva).removeClass("text-morado");
            $("#btp"+tabActiva).addClass("text-white bg-morado");
        });

        $("#btp2").on("click", function() {
            $("#btp"+tabActiva).removeClass("text-white bg-morado");
            $("#btp"+tabActiva).addClass("text-morado");
            tabActiva = 2;
            $("#btp"+tabActiva).removeClass("text-morado");
            $("#btp"+tabActiva).addClass("text-white bg-morado");
        });
        
        $("#btp3").on("click", function() {
            $("#btp"+tabActiva).removeClass("text-white bg-morado");
            $("#btp"+tabActiva).addClass("text-morado");
            tabActiva = 3;
            $("#btp"+tabActiva).removeClass("text-morado");
            $("#btp"+tabActiva).addClass("text-white bg-morado");
        });
    
        let tabActiva2 = 1;
        $("#btc1").addClass("text-white bg-morado");
        for (var i = 2; i <= 4; i++) {
            $("#btc"+i).addClass("text-morado");
        }

        $("#btc1").on("click", function() {
            $("#btc"+tabActiva2).removeClass("text-white bg-morado");
            $("#btc"+tabActiva2).addClass("text-morado");
            tabActiva2 = 1;
            $("#btc"+tabActiva2).removeClass("text-morado");
            $("#btc"+tabActiva2).addClass("text-white bg-morado");
        });

        $("#btc2").on("click", function() {
            $("#btc"+tabActiva2).removeClass("text-white bg-morado");
            $("#btc"+tabActiva2).addClass("text-morado");
            tabActiva2 = 2;
            $("#btc"+tabActiva2).removeClass("text-morado");
            $("#btc"+tabActiva2).addClass("text-white bg-morado");
        });
        
        $("#btc3").on("click", function() {
            $("#btc"+tabActiva2).removeClass("text-white bg-morado");
            $("#btc"+tabActiva2).addClass("text-morado");
            tabActiva2 = 3;
            $("#btc"+tabActiva2).removeClass("text-morado");
            $("#btc"+tabActiva2).addClass("text-white bg-morado");
        });

        $("#btc4").on("click", function() {
            $("#btc"+tabActiva2).removeClass("text-white bg-morado");
            $("#btc"+tabActiva2).addClass("text-morado");
            tabActiva2 = 4;
            $("#btc"+tabActiva2).removeClass("text-morado");
            $("#btc"+tabActiva2).addClass("text-white bg-morado");
        });

        function cerrarModal() {
                $("#cliente_existente").modal("toggle");
                $("#cliente_invalido").modal("toggle");
        };

        const xHTTP = new XMLHttpRequest();
        bandera = false;

        xHTTP.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    validado = JSON.parse(xHTTP.responseText)["validado"]
                    if (validado != "") {
                        $("#cliente_invalido").modal("toggle");
                        $("#cliente_existente").modal("toggle");
                    } else {
                        bandera = true;
                    }
                }
            }
            
        $("#form-nuevo").on("submit", function() {
            url = "http://localhost:5000/val_usuario/" + $("#email-field").val();
            xHTTP.open("GET", url, false);
            xHTTP.send();
            if (!bandera) {
                return false;
            }
        });    

    </script>
</body>
</html>